row.names(f)=row.names(vegT2)
listdist[[i]]<-f
}
distTT=ts+disTs
VegGp=data.frame(Poales=(vegTr2$AGRSCA+vegTr2$CALCAN+vegTr2$CARADU+vegTr2$CARHOU+vegTr2$CARSPP+vegTr2$CARUMB+vegTr2$DANSPI+vegTr2$ORYASP+vegTr2$ORYCAN+vegTr2$ORYPUN+vegTr2$PANDEP+vegTr2$PANLAN),Vaccinium=(vegTr2$VACANG+vegTr2$VACMYR),DANSPI=vegTr2$DANSPI,herb=(vegTr2$ANEQUI+vegTr2$CORCAN+vegTr2$EUPSPP+vegTr2$LINBOR+vegTr2$MAICAN+vegTr2$MELLIN+vegTr2$POLPAU+vegTr2$POTTRI+vegTr2$RUBIDA+vegTr2$RUBPUB+vegTr2$TRIBOR+vegTr2$VIOADU))
ETAb=cbind(ET3,VegAb,SlMiA21,VegGp,CWMs,CWMc,CWMa)
head(ETAb)
ETAb=cbind(ET3,VegAb,SlMiA21,VegGp,CWMs,CWMc,CWMa)
data=data.frame(ETAb,CWMoD[,1:7],CWMrD[,1:7])
data$Plot=rep(c("B","D"),15)
dataAll=merge(data,DecTemp,by.x=c("Bloc","System","Plot"),by.y=c("Block","System","Plot"),all=TRUE)
dataAll=unique(dataAll)
dataAllTNA=dataAll[is.na(dataAll$Mesh_size),]
dataAllT2=subset(dataAll,Mesh_size!="NA")
dataAllT=rbind(dataAllT2,dataAllTNA)
dataAllT$System <- ordered(dataAllT$System, levels=c("B","F","C"))
dataAllT=unique(dataAllT)
dataAllT$WD=dataAllT$CWD.recent+dataAllT$CWD.decay+dataAllT$FWD
dataAllT=dataAllT[,-c(56,58,60,61,62)]
head(dataAllT)
dataAllT=data.frame(dataAllT[,c(1:3,14:56)],decostand(dataAllT[,c(4:13,57:59)],method="standardize",na.rm=TRUE))
dataAllTn=dataAllT
head(dataAlTn)
head(dataAlT)
dataAllTn=dataAllT
head(dataAllT)
for(i in 1:33)
{
if (dataAllTn$Mesh_size[i]=="2")
{
dataAllTn[i,c(5:6,11:33)]=NA
}
else if (dataAllTn$Mesh_size[i]=="0.05")
{
dataAllTn[i,c(34:45,5:6,11:33)]=NA
}
}
for(i in 1:33)
{
if (dataAllT$Mesh_size[i]=="2")
{
dataAllT[i,c(5:6,11:33)]=0
}
else if (dataAllT$Mesh_size[i]=="0.05")
{
dataAllT[i,c(34:45,5:6,11:33)]=0
}
}
data.modlist = list(
lme(Moss ~ Mineral*CWD.decay, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(Hemiedaphic ~ Mineral+Poales+runners, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(Euedaphic.1 ~ Mineral+Carnivore, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(UROCAN ~ Moss, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(FG_gra ~ Mineral+DANSPI, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(runners ~ Poales+Vaccinium+CWD.recent*Mineral, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(Moisture_level ~ Moss+Mineral, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(web_builders ~ Moisture_level*herb, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(Carnivore ~ Moss, random=~1|System, na.action = na.omit, data = dataAllTn),
lme(ARIFUS ~ Moss, random=~1|System, na.action = na.omit, data = dataAllTn)
)
sem.fit(data.modlist,dataAllTn)
staph=read.table("DatasGood/Staph/StaphAb.csv",head=TRUE,sep=",",row.names=1)
staph=log(staph+1)
staph2=TrSelect(staph,siteC)
staph2=staph2[,-36]
ss=apply(staph2,2,sum)
staph2=staph2[,-(which(ss==0))]
staph3=decostand(staph2, method="hellinger")
PCAstaph=dudi.pca(staph3,scannf=FALSE,nf=2)
summary(PCAstaph)
RDAstaph=pcaiv(PCAstaph,siteC$TrName,scannf=FALSE,nf=2)
scE=RDAstaph$li
g=merge(scE,siteC,by.x="row.names",by.y="X")
row.names(g)=g[,1]
scT=g[,-1]
s.class(scT[,1:2],scT$TrName,col=c("blue4","chartreuse","darkred"),xlim=c(-10,10),ylim=c(-10,10))
s.arrow(RDAstaph$co*10,add.plot=TRUE)
summary(RDAstaph)
anova(betadisper(vegdist(staph3, method="bray"),siteC$Tr))
ADONIS1=adonis(staph3~siteC$Tr, permutations = 99999, method = "bray", contr.ordered = "contr.sum")
anova(betadisper(vegdist(staph3, method="bray"),siteC$Tr))
ADONIS1=adonis(staph3~siteC$Tr, permutations = 99999, method = "bray", contr.ordered = "contr.sum")
ADONIS1
pairwise.perm.manova(vegdist(staph3, method="bray"), siteC$Tr)
vegAb=decostand(vegTr3, method="hellinger")
pcaAb=dudi.coa(vegAb,scannf=FALSE,nf=2)
rlqmix <- rlqESLTP(pcaEnv, pcaspa, pcaAb, pcotrait, pcophy, scan = FALSE, nf = 2)
library(vegan)
library(ade4)
library(VIF)
library(plyr)
library(FD)
library(cluster)
library(ggplot2)
library(reshape)
library(SDMTools)
library(RVAideMemoire)
library(lavaan)
library(ggm)
library(nlme)
library(lme4)
library(piecewiseSEM)
spat=read.table("~/Documents/Ecole/These/Zurich/MultiTroph/DatasGood/GPSPoint.csv",head=TRUE,sep=";")
summary(RDAorT)
orT1=read.table("/Users/idaline/Documents/Ecole/These/Zurich/MultiTroph/DatasGood/Laurent/Q_Oribatida_IL2013.csv",head=TRUE,sep=";")
mouth=orT1[,c(1,3)]
mouth=melt(mouth)
mouth$value=1
mouth=cast(mouth,Taxa~Mouthpart_structure)
mouth[is.na(mouth)]=0
library(ade4)
library(ggplot2)
ab=read.table("~/Documents/Ecole/These/IsLakeModel/AbSp.txt",head=TRUE)
sp=read.table("~/Documents/Ecole/These/IsLakeModel/IsLkMassTrait.txt",head=TRUE)
sp=data.frame(Num=sp$Num,sp[,1:11])
ab10=ab
ab10[ab!=0]=1
ab10$B=ab10[,1]+ab10[,4]+ab10[,7]+ab10[,10]+ab10[,13]
ab10$C=ab10[,2]+ab10[,5]+ab10[,8]+ab10[,11]+ab10[,14]
ab10$F=ab10[,3]+ab10[,6]+ab10[,9]+ab10[,12]+ab10[,15]
dat=data.frame(Sp=row.names(ab10),BC=NA,FC=NA,BF=NA)
dat$BC[which(ab10$B!=0 & ab10$C!=0)]="Com"
dat$BC[which(ab10$B==0 & ab10$C!=0)]="Extinc"
dat$BC[which(ab10$B!=0 & ab10$C==0)]="New"
dat$BC[which(ab10$B==0 & ab10$C==0)]="Null"
dat$FC[which(ab10$F!=0 & ab10$C!=0)]="Com"
dat$FC[which(ab10$F==0 & ab10$C!=0)]="Extinc"
dat$FC[which(ab10$F!=0 & ab10$C==0)]="New"
dat$FC[which(ab10$F==0 & ab10$C==0)]="Null"
dat$BF[which(ab10$B!=0 & ab10$F!=0)]="Com"
dat$BF[which(ab10$B==0 & ab10$F!=0)]="Extinc"
dat$BF[which(ab10$B!=0 & ab10$F==0)]="New"
dat$BF[which(ab10$B==0 & ab10$F==0)]="Null"
dat$BF=as.factor(dat$BF)
dat$FC=as.factor(dat$FC)
dat$BC=as.factor(dat$BC)
datSp=merge(dat,sp,by.x="Sp",by.y="Num")
datSp$Though=as.ordered(datSp$Though)
datSp$Mobility=as.ordered(datSp$Mobility)
head(datSp)
head(sp)
sp=read.table("~/Documents/Ecole/These/IsLakeModel/IsLkMassTrait.txt",head=TRUE)
head(sp)
library(ade4)
library(ggplot2)
ab=read.table("~/Documents/Ecole/These/IsLakeModel/AbSp.txt",head=TRUE)
sp=read.table("~/Documents/Ecole/These/IsLakeModel/IsLkMassTrait.txt",head=TRUE)
ab10=ab
ab10[ab!=0]=1
ab10$B=ab10[,1]+ab10[,4]+ab10[,7]+ab10[,10]+ab10[,13]
ab10$C=ab10[,2]+ab10[,5]+ab10[,8]+ab10[,11]+ab10[,14]
ab10$F=ab10[,3]+ab10[,6]+ab10[,9]+ab10[,12]+ab10[,15]
dat=data.frame(Sp=row.names(ab10),BC=NA,FC=NA,BF=NA)
dat$BC[which(ab10$B!=0 & ab10$C!=0)]="Com"
dat$BC[which(ab10$B==0 & ab10$C!=0)]="Extinc"
dat$BC[which(ab10$B!=0 & ab10$C==0)]="New"
dat$BC[which(ab10$B==0 & ab10$C==0)]="Null"
dat$FC[which(ab10$F!=0 & ab10$C!=0)]="Com"
dat$FC[which(ab10$F==0 & ab10$C!=0)]="Extinc"
dat$FC[which(ab10$F!=0 & ab10$C==0)]="New"
dat$FC[which(ab10$F==0 & ab10$C==0)]="Null"
dat$BF[which(ab10$B!=0 & ab10$F!=0)]="Com"
dat$BF[which(ab10$B==0 & ab10$F!=0)]="Extinc"
dat$BF[which(ab10$B!=0 & ab10$F==0)]="New"
dat$BF[which(ab10$B==0 & ab10$F==0)]="Null"
dat$BF=as.factor(dat$BF)
dat$FC=as.factor(dat$FC)
dat$BC=as.factor(dat$BC)
datSp=merge(dat,sp,by.x="Sp",by.y="Num")
datSp$Though=as.ordered(datSp$Though)
datSp$Mobility=as.ordered(datSp$Mobility)
datSpA=subset(datSp,Kingdom=="Animalia" & Phylum!="Nematoda")
datBC=datSpA[,c(2,12:23)]
row.names(datBC)=datSpA[,1]
datBC=subset(datBC,BC!="Null")
datBC=droplevels(datBC)
pcaBC=dudi.mix(datBC[,2:13],scannf=FALSE,nf=4)
s.class(pcaBC$li,datBC$BC,col=c("blue","red","green"),cstar=0)
s.arrow(pcaBC$co,add.plot=TRUE)
datFC=datSpA[,c(3,12:23)]
row.names(datFC)=datSpA[,1]
datFC=subset(datFC,FC!="Null")
datFC=droplevels(datFC)
pcaFC=dudi.mix(datFC[,2:13],scannf=FALSE,nf=4)
s.class(pcaFC$li,datFC$FC,col=c("blue","red","green"),cstar=0)
s.arrow(pcaFC$co,add.plot=TRUE)
datBF=datSpA[,c(4,12:23)]
row.names(datBF)=datSpA[,1]
datBF=subset(datBF,BF!="Null")
datBF=droplevels(datBF)
pcaBF=dudi.mix(datBF[,2:13],scannf=FALSE,nf=4)
s.class(pcaBF$li,datBF$BF,col=c("blue","red","green"),cstar=0)
s.arrow(pcaBF$co,add.plot=TRUE)
inter=read.table("~/Documents/Ecole/These/IsLakeModel/predIsLake.txt")
datInter1=merge(dat,inter,by.x="Sp",by.y="ress")
colnames(datInter1)[1:4]=c("ress","rBC","rFC","rBF")
datInter1=merge(dat,datInter1,by.x="Sp",by.y="cons")
colnames(datInter1)[1:4]=c("cons","cBC","cFC","cBF")
head(datInter)
head(datInter1)
datInter=subset(datInter1,Carnivore.y==1)
g=datInter[,c(1,2,6)]
g=subset(g,cBC!="Null")
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$rBC=="Extinc")]=1
g$Com[which(g$rBC=="Com")]=1
g$New[which(g$rBC=="New")]=1
gE=aggregate(g$Extinc,by=list(g$cons,g$cBC),sum)
gC=aggregate(g$Com,by=list(g$cons,g$cBC),sum)
gN=aggregate(g$New,by=list(g$cons,g$cBC),sum)
consBC=data.frame(cons=gN$Group.1,cBC=gN$Group.2,rExt=gE$x,rNew=gN$x,rCom=gC$x)
consBC$sum=apply(consBC[,3:5],1,sum)
consBC=subset(consBC,sum!=0)
boxplot(rExt~cBC,consBC,main="Nombre de ressources éteintes")
boxplot(rNew~cBC,consBC,main="Nombre de nouvelles ressources")
g=datInter[,c(1,3,7)]
g=subset(g,cFC!="Null")
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$rFC=="Extinc")]=1
g$Com[which(g$rFC=="Com")]=1
g$New[which(g$rFC=="New")]=1
gE=aggregate(g$Extinc,by=list(g$cons,g$cFC),sum)
gC=aggregate(g$Com,by=list(g$cons,g$cFC),sum)
gN=aggregate(g$New,by=list(g$cons,g$cFC),sum)
consFC=data.frame(cons=gN$Group.1,cFC=gN$Group.2,rExt=gE$x,rNew=gN$x,rCom=gC$x)
consFC$sum=apply(consFC[,3:5],1,sum)
consFC=subset(consFC,sum!=0)
boxplot(rExt~cFC,consFC,main="Nombre de ressources éteintes")
boxplot(rNew~cFC,consFC,main="Nombre de nouvelles ressources")
g=datInter[,c(1,4,8)]
g=subset(g,cBF!="Null")
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$rBF=="Extinc")]=1
g$Com[which(g$rBF=="Com")]=1
g$New[which(g$rBF=="New")]=1
gE=aggregate(g$Extinc,by=list(g$cons,g$cBF),sum)
gC=aggregate(g$Com,by=list(g$cons,g$cBF),sum)
gN=aggregate(g$New,by=list(g$cons,g$cBF),sum)
consBF=data.frame(cons=gN$Group.1,cBF=gN$Group.2,rExt=gE$x,rNew=gN$x,rCom=gC$x)
consBF$sum=apply(consBF[,3:5],1,sum)
consBF=subset(consBF,sum!=0)
boxplot(rExt~cBF,consBF, main="Nombre de ressources éteintes")
boxplot(rNew~cBF,consBF, main="Nombre de nouvelles ressources")
datInter=subset(datInter1,Kingdom.y=="Animalia")
datInter=datInter[,1:2]
g=datInter[,c(5,6,2)]
g=subset(g,rBC!="Null")
g=subset(g,cBC!="Null")
g=droplevels(g)
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$cBC=="Extinc")]=1
g$Com[which(g$cBC=="Com")]=1
g$New[which(g$cBC=="New")]=1
gE=aggregate(g$Extinc,by=list(g$ress,g$rBC),sum)
gC=aggregate(g$Com,by=list(g$ress,g$rBC),sum)
gN=aggregate(g$New,by=list(g$ress,g$rBC),sum)
ressBC=data.frame(ress=gN$Group.1,rBC=gN$Group.2,cExt=gE$x,cNew=gN$x,cCom=gC$x)
ressBC$sum=apply(ressBC[,3:5],1,sum)
ressBC$cExt=ressBC$cExt/ressBC$sum
ressBC$cNew=ressBC$cNew/ressBC$sum
ressBC$cCom=ressBC$cCom/ressBC$sum
boxplot(cExt~rBC,ressBC, main="Nombre de consommateurs éteintes")
datInter=subset(datInter1,Kingdom.y=="Animalia")
datInter=datInter[,1:2]
head(datInter)
head(datInter1)
datInter=subset(datInter1,Kingdom.y=="Animalia")
g=datInter[,c(5,6,2)]
g=subset(g,rBC!="Null")
g=subset(g,cBC!="Null")
g=droplevels(g)
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$cBC=="Extinc")]=1
g$Com[which(g$cBC=="Com")]=1
g$New[which(g$cBC=="New")]=1
gE=aggregate(g$Extinc,by=list(g$ress,g$rBC),sum)
gC=aggregate(g$Com,by=list(g$ress,g$rBC),sum)
gN=aggregate(g$New,by=list(g$ress,g$rBC),sum)
ressBC=data.frame(ress=gN$Group.1,rBC=gN$Group.2,cExt=gE$x,cNew=gN$x,cCom=gC$x)
ressBC$sum=apply(ressBC[,3:5],1,sum)
ressBC$cExt=ressBC$cExt/ressBC$sum
ressBC$cNew=ressBC$cNew/ressBC$sum
ressBC$cCom=ressBC$cCom/ressBC$sum
boxplot(cExt~rBC,ressBC, main="Nombre de consommateurs éteintes")
boxplot(cNew~rBC,ressBC, main="Nombre de nouveaux consommateurs")
g=datInter[,c(5,7,3)]
g=subset(g,rFC!="Null")
g=subset(g,cFC!="Null")
g=droplevels(g)
g$Extinc=0
g$Com=0
g$New=0
g$Extinc[which(g$cFC=="Extinc")]=1
g$Com[which(g$cFC=="Com")]=1
g$New[which(g$cFC=="New")]=1
gE=aggregate(g$Extinc,by=list(g$ress,g$rFC),sum)
gC=aggregate(g$Com,by=list(g$ress,g$rFC),sum)
gN=aggregate(g$New,by=list(g$ress,g$rFC),sum)
ressFC=data.frame(ress=gN$Group.1,rFC=gN$Group.2,cExt=gE$x,cNew=gN$x,cCom=gC$x)
ressFC$sum=apply(ressFC[,3:5],1,sum)
ressFC$cExt=ressFC$cExt/ressFC$sum
ressFC$cNew=ressFC$cNew/ressFC$sum
ressFC$cCom=ressFC$cCom/ressFC$sum
boxplot(cExt~rFC,ressFC,main="Nombre de consommateurs éteintes")
boxplot(cNew~rFC,ressFC, main="Nombre de nouveaux consommateurs")
source('~/Documents/Ecole/These/IsLakeModel/Mammouth/R/fonction/PROP.R', chdir = TRUE)
source("~/Documents/Ecole/These/IsLakeModel/Mammouth/R/fonction/MatrixInter.R")
sp=read.table("~/Documents/Ecole/These/IsLakeModel/IsLkMassTrait.txt",head=TRUE)
filenames <- list.files("~/Documents/Ecole/These/IsLakeModel/Mammouth/R/FW/", full.names=FALSE)
dataC=sp
dataR=sp
for (h in 1:length(filenames))
{
fw=read.table(paste("~/Documents/Ecole/These/IsLakeModel/Mammouth/R/FW/",filenames[h],sep=""),sep=";",head=T)
fw$count=1
NbCons=aggregate(fw$count,by=list(fw$ress),sum)
NbRess=aggregate(fw$count,by=list(fw$cons),sum)
name=strtrim(filenames[h],4)
dataC=merge(dataC,NbCons,by.x="Num",by.y="Group.1",all=TRUE)
dataR=merge(dataR,NbRess,by.x="Num",by.y="Group.1",all=TRUE)
colnames(dataC)[ncol(dataC)]=paste("NbCons",name,sep="_")
colnames(dataR)[ncol(dataR)]=paste("NbRess",name,sep="_")
}
data2=dataR[,c(1,9:12,22:36)]
data2$gp="P"
data2$gp[which(data2$Herbivore==1)]="H"
data2$gp[which(data2$Fungivore==1)]="F"
data2$gp[which(data2$Detritivore==1)]="D"
data2$gp[which(data2$Fungivore==1 & data2$Detritivore==1 & data2$Herbivore==1)]="B"
data2$gp[which(data2$Carnivore==1)]="C"
data2$gp=as.factor(data2$gp)
data3=data2[,-(1:5)]
o=0
data4=data.frame(count=NA,Tr=NA,gp=NA)
for (i in 1:5)
{
B=data.frame(count=data3[,1+o],Tr="B",gp=data3$gp)
C=data.frame(count=data3[,2+o],Tr="C",gp=data3$gp)
F=data.frame(count=data3[,3+o],Tr="F",gp=data3$gp)
data4=rbind(data4,B,C,F)
o=o+3
}
data4=subset(data4,!is.na(data4$count))
ggplot(data4, aes(x = Tr, y = count, fill = gp)) +
geom_boxplot()
data2=dataC[,c(1,9:12,22:36)]
data2$gp="P"
data2$gp[which(data2$Herbivore==1)]="H"
data2$gp[which(data2$Fungivore==1)]="F"
data2$gp[which(data2$Detritivore==1)]="D"
data2$gp[which(data2$Fungivore==1 & data2$Detritivore==1 & data2$Herbivore==1)]="B"
data2$gp[which(data2$Carnivore==1)]="C"
data2$gp=as.factor(data2$gp)
data3=data2[,-(1:5)]
o=0
data4=data.frame(count=NA,Tr=NA,gp=NA)
for (i in 1:5)
{
B=data.frame(count=data3[,1+o],Tr="B",gp=data3$gp)
C=data.frame(count=data3[,2+o],Tr="C",gp=data3$gp)
F=data.frame(count=data3[,3+o],Tr="F",gp=data3$gp)
data4=rbind(data4,B,C,F)
o=o+3
}
data4=subset(data4,!is.na(data4$count))
ggplot(data4, aes(x = Tr, y = count, fill = gp)) +
geom_boxplot()
data2=subset(dataC,Kingdom=="Animalia")
data2=data2[,c(1,7,22:36)]
data3=data2[,-1]
colnames(data3)[1]="gp"
o=0
data4=data.frame(count=NA,Tr=NA,gp=NA)
for (i in 1:5)
{
B=data.frame(count=data3[,2+o],Tr="B",gp=data3$gp)
C=data.frame(count=data3[,3+o],Tr="C",gp=data3$gp)
F=data.frame(count=data3[,4+o],Tr="F",gp=data3$gp)
data4=rbind(data4,B,C,F)
o=o+3
}
data4=subset(data4,!is.na(data4$count))
data4$Tr=ordered(data4$Tr,levels=c("C","F","B"))
ggplot(data4, aes(x = Tr, y = count, fill = gp)) +
geom_boxplot()
h=1
Prop=data.frame(Plot=NA,NS=NA,NProd=NA,NInt=NA,NTop=NA,NHerb=NA,NL=NA,C=NA,GenSD=NA,VulSD=NA,MeanDBase=NA,MaxDBase=NA,MeanTR=NA,MaxTR=NA,Omn=NA,sim=NA,mod=NA)
fw=read.table(paste("~/Documents/Ecole/These/IsLakeModel/Mammouth/R/FW/",filenames[h],sep=""),sep=";",head=T)
fw$inter=1
fw2=data.frame(ress=fw$cons,cons=fw$ress,inter=0)
fw3=rbind(fw,fw2)
fw3$uni=duplicated(fw3[,1:2])
fw3=subset(fw3,uni=="FALSE")
fw3=fw3[,-4]
colnames(fw3)=c("resso","conso","inter")
M=cast(fw3,resso~conso,sum)
resProp=stats_fn(M)
name=strtrim(filenames[h],4)
resProp=data.frame(Plot=name,resProp)
Prop=rbind(Prop,resProp)
library(reshape)
fw=read.table(paste("~/Documents/Ecole/These/IsLakeModel/Mammouth/R/FW/",filenames[h],sep=""),sep=";",head=T)
fw$inter=1
fw2=data.frame(ress=fw$cons,cons=fw$ress,inter=0)
fw3=rbind(fw,fw2)
fw3$uni=duplicated(fw3[,1:2])
fw3=subset(fw3,uni=="FALSE")
fw3=fw3[,-4]
colnames(fw3)=c("resso","conso","inter")
M=cast(fw3,resso~conso,sum)
resProp=stats_fn(M)
name=strtrim(filenames[h],4)
resProp=data.frame(Plot=name,resProp)
Prop=rbind(Prop,resProp)
Prop$Tr=rep(c("B","C","F"),5)
Prop$Tr=ordered(Prop$Tr,levels=c("C","F","B"))
pcaProp=dudi.pca(Prop[,2:17],scannf=FALSE,nf=4)
head(Prop)
head(Prop)
library(ade4)
library(ggplot2)
library(reshape)
ab=read.table("~/Documents/Ecole/These/IsLakeModel/AbSp.txt",head=TRUE)
sp=read.table("~/Documents/Ecole/These/IsLakeModel/IsLkMassTrait.txt",head=TRUE)
ab10=ab
ab10[ab!=0]=1
ab10$B=ab10[,1]+ab10[,4]+ab10[,7]+ab10[,10]+ab10[,13]
ab10$C=ab10[,2]+ab10[,5]+ab10[,8]+ab10[,11]+ab10[,14]
ab10$F=ab10[,3]+ab10[,6]+ab10[,9]+ab10[,12]+ab10[,15]
dat=data.frame(Sp=row.names(ab10),BC=NA,FC=NA,BF=NA)
dat$BC[which(ab10$B!=0 & ab10$C!=0)]="Com"
dat$BC[which(ab10$B==0 & ab10$C!=0)]="Extinc"
dat$BC[which(ab10$B!=0 & ab10$C==0)]="New"
dat$BC[which(ab10$B==0 & ab10$C==0)]="Null"
dat$FC[which(ab10$F!=0 & ab10$C!=0)]="Com"
dat$FC[which(ab10$F==0 & ab10$C!=0)]="Extinc"
dat$FC[which(ab10$F!=0 & ab10$C==0)]="New"
dat$FC[which(ab10$F==0 & ab10$C==0)]="Null"
dat$BF[which(ab10$B!=0 & ab10$F!=0)]="Com"
dat$BF[which(ab10$B==0 & ab10$F!=0)]="Extinc"
dat$BF[which(ab10$B!=0 & ab10$F==0)]="New"
dat$BF[which(ab10$B==0 & ab10$F==0)]="Null"
dat$BF=as.factor(dat$BF)
dat$FC=as.factor(dat$FC)
dat$BC=as.factor(dat$BC)
datSp=merge(dat,sp,by.x="Sp",by.y="Num")
datSp$Though=as.ordered(datSp$Though)
datSp$Mobility=as.ordered(datSp$Mobility)
datSpA=subset(datSp,Kingdom=="Animalia" & Phylum!="Nematoda")
```
# Quels traits caractérisent les nouvelles espèces et les éteintes ?
## De C à B
```{r, echo=FALSE}
datBC=datSpA[,c(2,7:23)]
row.names(datBC)=datSpA[,1]
datBC=subset(datBC,BC!="Null")
datBC=droplevels(datBC)
head(datBC)
det=subset(datBC,Detritivore==1)
summary(det)
det
subset(datSpA,row.names=="91 I")
subset(datSpA,row.names(datSpA)=="91 I")
head(datSpA)
subset(datSpA,Sp=="91 I")
datFC=datSpA[,c(3,7:23)]
row.names(datFC)=datSpA[,1]
datFC=subset(datFC,FC!="Null")
datFC=droplevels(datFC)
subset(datFC,Detritivore==1)
subset(datFC,Detritivore==1 & FC!="Extinc")
det=subset(datBC,Fungivore==1)
det
det=subset(datBC,Herbivore==1)
det
head(datBC)
f=subset(datBC,Order=="Araneae")
f=subset(f, mass==3.17)
head(f)
f=subset(datBC,Order=="Araneae")
summary(f)
f=subset(f,mass<4)
summary(f)
f=subset(f,mass<3.3)
summary(f)
f=subset(f,mass==3.1734)
f
f=subset(datBC,Order=="Araneae")
subset(f,mass<3.5)
head(inter)
inter=read.table("~/Documents/Ecole/These/IsLakeModel/predIsLake.txt")
datInter1=merge(dat,inter,by.x="Sp",by.y="ress")
colnames(datInter1)[1:4]=c("ress","rBC","rFC","rBF")
datInter1=merge(dat,datInter1,by.x="Sp",by.y="cons")
colnames(datInter1)[1:4]=c("cons","cBC","cFC","cBF")
datInter=subset(datInter1,Carnivore.y==1)
head(datInter)
subset(datInter,cons=="254 I")
g=subset(datInter,cons=="254 I")
g$Order.x
datFC
subset(datFC,Order=="Araneae")
